<ion-header>
  <ion-toolbar style="--background: #ff6b00; --color: #fff;">
    <ion-buttons slot="start">
      <ion-menu-button></ion-menu-button>
    </ion-buttons>
    <ion-title>Feeding Points</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true" class="feeding-page">

  <!-- üîç Search -->
  <ion-searchbar
    [(ngModel)]="searchTerm"
    (ionInput)="loadFeedingPoints()"
    placeholder="Search by name, food item, address"
    show-clear-button="always">
  </ion-searchbar>

  <!-- üîΩ Filters -->
  <div class="filters">
    <ion-select interface="popover" placeholder="Select City" [(ngModel)]="selectedCity" (ionChange)="loadFeedingPoints()">
      <ion-select-option value="">All Cities</ion-select-option>
      <ion-select-option value="Indore">Indore</ion-select-option>
      <ion-select-option value="Bhopal">Bhopal</ion-select-option>
    </ion-select>

    <ion-segment [(ngModel)]="selectedType" (ionChange)="loadFeedingPoints()">
      <ion-segment-button value="">
        <ion-label>All</ion-label>
      </ion-segment-button>
      <ion-segment-button value="individual">
        <ion-label>Individual</ion-label>
      </ion-segment-button>
      <ion-segment-button value="ngo">
        <ion-label>NGO</ion-label>
      </ion-segment-button>
    </ion-segment>
  </div>

  <!-- üîÑ Loader -->
  <ion-spinner *ngIf="loading" class="spinner-center" color="warning"></ion-spinner>

  <!-- üìå Feeding List -->
  <ion-card *ngFor="let fp of feedingPoints" class="feeding-card">
    <ion-card-header class="feeding-header">
      <ion-card-title>{{ fp.name }}</ion-card-title>
      <ion-badge class="type-badge" [color]="fp.is_individual ? 'warning' : 'tertiary'">
        {{ fp.is_individual ? 'Individual' : 'NGO' }}
      </ion-badge>
    </ion-card-header>

    <ion-card-content>
      <!-- Contact Row -->
      <div class="row contact-row">
        <span>üìû {{ fp.contact }}</span>
        <div class="btn-right">
          <ion-button size="small" fill="outline" class="outline-btn" (click)="call(fp.contact)">
            Call
          </ion-button>
          <ion-button size="small" fill="outline" class="outline-btn" (click)="whatsapp(fp.contact)">
            WhatsApp
          </ion-button>
        </div>
      </div>

      <!-- Address -->
      <p class="address">üìç {{ fp.address }}, {{ fp.city }}</p>

      <!-- Food Items -->
      <div class="food-tags">
        <ion-chip *ngFor="let item of fp.food_items">{{ item }}</ion-chip>
      </div>

      <!-- Actions -->
      <div class="row actions-row">
        <ion-button expand="block" fill="solid" class="solid-btn"
          (click)="openInMaps(fp.lat, fp.lng)">
          Open in Google Maps
        </ion-button>
      </div>
    </ion-card-content>
  </ion-card>

  <!-- ‚ùå No Data -->
  <div *ngIf="!loading && feedingPoints.length === 0" class="no-data">
    <ion-icon name="alert-circle-outline"></ion-icon>
    <p>No feeding points found.</p>
  </div>
</ion-content>
